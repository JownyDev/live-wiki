---
import { getLangFromUrl, useTranslations } from '../i18n/utils';
import { getRelativeLocaleUrl } from 'astro:i18n';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
const searchEndpoint = getRelativeLocaleUrl(lang, '/search.json');
const resultLimit = 12;
---

<div
  id="search"
  class="search"
  data-search
  data-search-lang={lang}
  data-search-endpoint={searchEndpoint}
  data-search-limit={resultLimit}
>
  <label class="search__label" for="search-input">{t('ui.search')}</label>
  <div class="search__control">
    <input
      id="search-input"
      class="search__input"
      type="search"
      name="q"
      placeholder={t('nav.search') + "..."}
      autocomplete="off"
      aria-controls="search-results"
    />
  </div>
  <div class="search__meta">
    <span class="search__status" data-search-status role="status" aria-live="polite">
    </span>
  </div>
  <ul id="search-results" class="search__results" data-search-results hidden></ul>
</div>
<script>
  import '../scripts/search-island.ts';
</script>
