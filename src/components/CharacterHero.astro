---
import EntityImage from './EntityImage.astro';
import InlineMetaList, { type InlineMetaItem } from './InlineMetaList.astro';

type Props = {
  name: string;
  imageUrl?: string;
  imageAlt?: string;
  meta?: InlineMetaItem[];
  updatedAt?: string;
};

const { name, imageUrl, imageAlt, meta = [], updatedAt } = Astro.props as Props;
const hasMeta = meta.length > 0;
const hasBadges = Astro.slots.has('badges');
const hasAside = Astro.slots.has('aside');
const resolvedAlt = imageAlt ?? name;
---

<header class="character-hero">
  <div class="character-hero__main">
    {imageUrl ? <EntityImage src={imageUrl} alt={resolvedAlt} variant="hero" /> : null}
    <div class="character-hero__content">
      {hasBadges ? (
        <div class="character-hero__badges">
          <slot name="badges" />
        </div>
      ) : null}
      <h1 class="character-hero__name">{name}</h1>
      {hasMeta ? <InlineMetaList items={meta} /> : null}
    </div>
  </div>
  {updatedAt || hasAside ? (
    <div class="character-hero__aside">
      {updatedAt ? <p class="character-hero__updated">{updatedAt}</p> : null}
      {hasAside ? <slot name="aside" /> : null}
    </div>
  ) : null}
</header>

<style>
  .character-hero {
    display: flex;
    flex-direction: column;
    gap: var(--space-4);
    padding: var(--space-4) 0;
    border-bottom: 1px solid var(--color-border);
    --entity-image-size: 12rem;
  }

  .character-hero__main {
    display: flex;
    flex-direction: column;
    gap: var(--space-4);
    align-items: flex-start;
  }

  .character-hero__content {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
  }

  .character-hero__badges {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-2);
  }

  .character-hero__name {
    margin: 0;
    font-size: 2rem;
    font-weight: 700;
    color: var(--color-text);
    letter-spacing: -0.02em;
  }

  .character-hero__aside {
    align-self: flex-end;
    text-align: right;
  }

  .character-hero__updated {
    margin: 0;
    font-size: 0.75rem;
    color: var(--color-muted);
  }

  @media (min-width: 900px) {
    .character-hero {
      padding: var(--space-4) 0 var(--space-5);
      --entity-image-size: 17rem;
    }

    .character-hero__main {
      flex-direction: row;
      align-items: center;
      justify-content: space-between;
      width: 100%;
      gap: var(--space-5);
    }

    .character-hero__content {
      flex: 1;
    }
  }
</style>
