---
import { Icon } from 'astro-icon/components';
import { getLangFromUrl, useTranslations } from '../i18n/utils';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---

<button
  class="theme-toggle"
  id="theme-toggle"
  title={t('ui.toggle_theme')}
  aria-label={t('ui.toggle_theme')}
>
  <Icon name="material-symbols:light-mode" class="theme-toggle__icon theme-toggle__icon--light" />
  <Icon name="material-symbols:dark-mode" class="theme-toggle__icon theme-toggle__icon--dark" />
</button>

<script>
  const handleToggleClick = () => {
    const element = document.documentElement;
    element.classList.toggle('light');

    const isLight = element.classList.contains('light');
    localStorage.setItem('theme', isLight ? 'light' : 'dark');
  };

  document
    .getElementById('theme-toggle')
    ?.addEventListener('click', handleToggleClick);
</script>