---
type Props = {
  title: string;
  summary?: string | null;
  href?: string;
  era?: string | null;
  date?: string;
  tags?: string[];
  side?: 'left' | 'right';
};

const { title, summary, href, era, date, tags = [], side = 'right' } = Astro.props as Props;
const hasTags = tags.length > 0;

// Extract year for the big label if possible
const year = date ? (date.includes('-') ? date.split('-')[0] : date) : null;
---

<div class="relative flex items-center justify-center group w-full">
  {/* The Node on the line */}
  <div class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-10 w-[14px] height-[14px] bg-accent rounded-full border-2 border-bg shadow-[0_0_15px_var(--color-accent)] h-[14px]"></div>
  
  <div class="grid grid-cols-2 w-full gap-8 lg:gap-24">
    {/* Left Side */}
    <div class={`flex flex-col justify-center ${side === 'left' ? 'order-2 pl-4 text-left' : 'order-1 pr-4 text-right'}`}>
      {era ? (
        <span class="text-[10px] font-bold text-accent uppercase tracking-[0.2em] mb-1">
          Era: {era}
        </span>
      ) : null}
      {year ? (
        <h3 class="font-serif text-3xl lg:text-4xl font-bold text-text">
          {year}
        </h3>
      ) : null}
    </div>

    {/* Right Side (The Card) */}
    <div class={`${side === 'left' ? 'order-1 pr-4' : 'order-2 pl-4'}`}>
      <div class="bg-surface border border-border p-6 lg:p-8 rounded-2xl shadow-xl hover:border-accent/50 transition-all">
        <div class="flex items-start justify-between mb-4">
          <h4 class="text-xl lg:text-2xl font-bold text-text">
            {title}
          </h4>
          {href ? (
            <a href={href} class="text-muted hover:text-accent transition-colors">
              <span class="material-symbols-outlined">open_in_new</span>
            </a>
          ) : null}
        </div>
        
        {summary ? (
          <p class="text-muted leading-relaxed mb-6 text-sm lg:text-base">
            {summary}
          </p>
        ) : null}
        
        {hasTags ? (
          <div class="flex flex-wrap gap-2">
            {tags.map((tag) => (
              <span class="px-3 py-1 bg-surface-muted text-[10px] font-bold rounded-full uppercase tracking-wider text-muted">
                {tag}
              </span>
            ))}
          </div>
        ) : null}
      </div>
    </div>
  </div>
</div>
