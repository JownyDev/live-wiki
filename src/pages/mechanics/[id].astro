---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Header from '../../components/Header.astro';
import MarkdownDescription from '../../components/MarkdownDescription.astro';
import Section from '../../components/Section.astro';
import { getMechanicById, listMechanics } from '../../lib/content/mechanics';

export async function getStaticPaths() {
  const mechanics = await listMechanics();
  return mechanics.map((mechanic) => ({
    params: { id: mechanic.id },
  }));
}

const id = Astro.params.id;
const mechanic = typeof id === 'string' ? await getMechanicById(id) : null;
const title = mechanic ? mechanic.name : 'Mecanica no encontrada';
---

<BaseLayout title={title}>
  {mechanic ? (
    <>
      <Header title={mechanic.name} />
      <MarkdownDescription content={mechanic.body} />
    </>
  ) : (
    <>
      <Header title="Mecanica no encontrada" />
      <Section>
        <p>La mecanica solicitada no existe.</p>
        <p>
          <a href="/mechanics">Volver a mecanicas</a>
        </p>
      </Section>
    </>
  )}
</BaseLayout>
