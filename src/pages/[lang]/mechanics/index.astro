---
import BaseLayout from '../../../layouts/BaseLayout.astro';
import Header from '../../../components/Header.astro';
import EntityList from '../../../components/EntityList.astro';
import Section from '../../../components/Section.astro';
import { listMechanics } from '../../../lib/content/mechanics';
import { languages } from '../../../i18n/ui';
import { useTranslations } from '../../../i18n/utils';
import { getRelativeLocaleUrl } from 'astro:i18n';

export function getStaticPaths() {
  return Object.keys(languages).map((lang) => ({ params: { lang } }));
}

const { lang } = Astro.params;
const t = useTranslations(lang as any);

const title = t('nav.mechanics');
const mechanics = await listMechanics();
const mechanicItems = mechanics.map(m => ({
  label: m.name,
  href: getRelativeLocaleUrl(lang as any, `/mechanics/${m.id}`)
}));
---

<BaseLayout title={title} lang={lang as any}>
  <Header title={title} icon="tune" />
  <Section>
    <div class="max-w-prose mb-12">
      <p class="text-muted text-sm">{t('desc.mechanics')}</p>
    </div>
    {mechanics.length === 0 ? <p>{t('mech.list.empty')}</p> : <EntityList items={mechanicItems} />}
  </Section>
</BaseLayout>
